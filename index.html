<!DOCTYPE html>
<html>
<head>
    <title>Simple Table Extension</title>
    <script type="text/javascript" src="https://extensions.tableau.com/resources/tableau.extensions.1.latest.min.js"></script>
</head>
<body>
    <div id="output">Loading...</div>

    <script>
        window.onload = function() {
            // Try to initialize the extension
            try {
                tableau.extensions.initializeAsync().then(function() {
                    document.getElementById('output').innerHTML = 'Extension initialized';
                    
                    // Get the dashboard and worksheets
                    const dashboard = tableau.extensions.dashboardContent.dashboard;
                    const worksheet = dashboard.worksheets[0]; // Get first worksheet
                    
                    if (worksheet) {
                        document.getElementById('output').innerHTML += '<br>Found worksheet: ' + worksheet.name;
                        
                        // Try to get data
                        worksheet.getSummaryDataAsync().then(function(data) {
                            let html = '<table border="1">';
                            
                            // Add headers
                            html += '<tr>';
                            data.columns.forEach(function(column) {
                                html += '<th>' + column.fieldName + '</th>';
                            });
                            html += '</tr>';
                            
                            // Add data
                            data.data.forEach(function(row) {
                                html += '<tr>';
                                row.forEach(function(cell) {
                                    html += '<td>' + cell.value + '</td>';
                                });
                                html += '</tr>';
                            });
                            
                            html += '</table>';
                            document.getElementById('output').innerHTML += html;
                        });
                    } else {
                        document.getElementById('output').innerHTML += '<br>No worksheet found';
                    }
                });
            } catch (e) {
                document.getElementById('output').innerHTML = 'Error: ' + e.message;
            }
        };
    </script>
</body>
</html>
